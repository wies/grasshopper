options "-symbexec-v2"

struct Node {
   var  data: Int;
   var  next: Node;
}

function f(x: Node, y: Node) returns (z: Int)
  requires acc(x.data) &*& acc(y.data)
  ensures x.data + y.data == z
{
  x.data + y.data
}

procedure add_nodes(a: Node, b: Node) returns (c: Node)
  requires acc(a.data) &*& acc(b.data)
  ensures acc(a.data) &*& acc(b.data) &*& acc(c.data) &*& c.data == a.data + b.data
{
  var z := f(a, b);
  c := new Node();
  c.data := z;
}

/*
procedure foo(a: Int) returns (b: Int)
  requires a == 2
  ensures b == 4

procedure pure_proc_call(c: Int, d: Int)
  requires c == 2 && d == c
  ensures c == 4
{
  c := foo(c);
}

*/
